<template>
    <div class="flex justify-center items-center h-screen">
        <div class="bg-white p-8 md:p-32 rounded shadow-md">
            <svg class="w-32 md:w-64 mx-auto mb-4 md:mb-12" viewBox="0 0 210 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M0 12.8406H16.0013C21.3016 12.8406 23.1649 14.5027 23.1649 18.5757V23.5827C23.1649 27.6558 21.3025 29.3179 16.0013 29.3179H0V12.8406ZM5.30222 25.0851H14.7117C16.9793 25.0851 17.8637 24.4697 17.8637 22.1255V19.8958C17.8637 17.5516 16.9793 16.9362 14.7117 16.9362H5.30222V25.0851Z"
                    fill="#003DBC"
                ></path>
                <path
                    d="M30.5887 12.8406H45.2936V16.6656H31.6821V19.3039H44.5758V22.7174H31.6821V25.3576H45.6041V29.3179H30.5887C28.264 29.3179 26.3789 27.5214 26.3789 25.3059V16.8516C26.3799 14.6361 28.264 12.8406 30.5887 12.8406Z"
                    fill="#003DBC"
                ></path>
                <path
                    d="M48.5039 23.9237H53.8061C53.8298 25.677 54.5702 25.8142 56.0984 25.8142H62.5926C63.7165 25.8142 64.8621 25.6995 64.8621 24.4264C64.8621 22.9917 64.242 22.9015 57.4106 22.9015C49.4346 22.9015 48.5286 21.9901 48.5286 17.9387C48.5286 14.9593 48.8145 12.6592 55.5009 12.6592H62.9031C69.0167 12.6592 69.5905 14.6398 69.5905 17.529V18.0533H64.2883C64.2883 16.8469 64.1463 16.347 61.7102 16.347H55.8361C54.6422 16.347 53.8298 16.7322 53.8298 17.6201C53.8298 19.0549 54.4756 19.1009 60.1593 19.0765C68.3976 19.0539 70.3073 19.5322 70.3073 24.3334C70.3073 28.772 68.7328 29.5001 61.6875 29.5001H55.2633C50.4392 29.5001 48.5039 28.6367 48.5039 25.0616V23.9237Z"
                    fill="#003DBC"
                ></path>
                <path
                    d="M73.5908 12.8406H78.893V18.8943H79.9845C81.2405 18.8943 82.4473 18.4348 83.3582 17.6108L88.6269 12.8406H95.2729L86.4767 20.8974L96.3713 29.3179H89.4373L83.1778 24.1352C82.2865 23.3976 81.1459 22.9908 79.9657 22.9908H78.8921V29.317H73.5898V12.8406H73.5908Z"
                    fill="#003DBC"
                ></path>
                <path d="M98.6562 12.8406H103.958V29.3179H98.6562V12.8406Z" fill="#003DBC"></path>
                <path
                    d="M107.83 12.8406H115.974L121.968 23.4456L127.96 12.8406H136.104V29.3179H130.946L130.908 19.8592C130.905 19.2175 130.011 18.9967 129.682 19.5567L123.949 29.3179H119.984L114.252 19.5567C113.923 18.9967 113.029 19.2175 113.026 19.8592L112.988 29.3179H107.83V12.8406Z"
                    fill="#003DBC"
                ></path>
                <path
                    d="M139.326 18.6217C139.326 13.796 142.167 12.6582 146.942 12.6582H155.444C160.222 12.6582 163.062 13.796 163.062 18.6217V23.5375C163.062 28.3613 160.222 29.4992 155.444 29.4992H146.942C142.167 29.4992 139.326 28.3613 139.326 23.5375V18.6217ZM144.77 21.9666C144.77 24.3569 145.295 25.2673 147.802 25.2673H154.584C157.092 25.2673 157.618 24.3578 157.618 21.9666V20.1917C157.618 18.1444 157.092 16.891 154.298 16.891H148.09C145.296 16.891 144.77 18.1434 144.77 20.1917V21.9666Z"
                    fill="#003DBC"
                ></path>
                <path d="M193.377 23.1363H180.143V16.4644C180.143 12.023 177.668 10.7931 173.467 10.6729V29.4991H199.454C199.327 25.4956 198.037 23.1363 193.377 23.1363Z" fill="#FFBE00"></path>
                <path
                    d="M196.629 7.1879H196.626C190.377 3.01994 182.299 0.5 173.467 0.5V6.85717C173.467 6.85717 174.144 6.84307 175.291 6.91448C179.407 7.10615 183.293 7.94238 186.776 9.28973C186.781 9.29161 186.785 9.29349 186.79 9.29537C187.807 9.68905 189.337 9.90985 190.904 9.90985H191.226H200.185C199.081 8.93833 197.892 8.0307 196.629 7.1879Z"
                    fill="#003DBC"
                ></path>
                <path
                    d="M209.999 29.499C209.999 23.6548 207.737 17.5974 203.873 13.094H183.846V19.4737H194.108C200.741 19.4737 203.099 23.4453 203.295 29.1232C203.3 29.2256 203.311 29.3223 203.313 29.4266C203.313 29.4266 203.313 29.4727 203.313 29.499H209.999Z"
                    fill="#FFBE00"
                ></path>
            </svg>
            <div class="mb-4 md:mb-8">
                <label for="email" class="block text-gray-700 text-sm md:text-base font-bold mb-2">Email</label>
                <input type="email" id="email" v-model="email" class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500" required />
            </div>
            <div class="mb-4 md:mb-8">
                <label for="password" class="block text-gray-700 text-sm md:text-base font-bold mb-2">Password</label>
                <input type="password" id="password" v-model="password" class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500" required />
            </div>
            <div v-if="errorMessage" class="p-4 mb-4 text-red-500 bg-red-100 rounded">
                {{ errorMessage }}
            </div>
            <div v-if="successMessage" class="p-4 mb-4 text-green-500 bg-green-100 rounded">
                {{ successMessage }}
            </div>
            <div v-show="!register">
                <button type="submit" @click="handleLogin" class="w-full bg-blue-500 text-white md:text-lg py-2 px-4 rounded hover:bg-blue-600 mb-4 md:mb-8">Login</button>
                <div class="text-center">
                    <a href="#" @click="handleRegister" class="text-gray-700 text-sm md:text-base font-bold">Register</a>
                </div>
            </div>
            <div v-show="register">
                <button type="submit" @click="handleRegisteration" class="w-full bg-red-500 text-white md:text-lg py-2 px-4 rounded hover:bg-red-600 mb-4 md:mb-8">Register</button>
                <div class="text-center">
                    <a href="#" @click="handleRegister" class="text-gray-700 text-sm md:text-base font-bold">Login</a>
                </div>
            </div>
        </div>
    </div>
</template>

<script setup>
import { ref } from "vue";
import { useRouter } from "vue-router";
import { useStore } from "vuex";

const router = useRouter();
const store = useStore();

const email = ref("");
const password = ref("");
const errorMessage = ref("");
const successMessage = ref("");
const register = ref(false);

function handleLogin() {
    store
        .dispatch("login", { email: email.value, password: password.value })
        .then(() => {
            if (store.state.isAuthenticated) {
                router.push({ name: "Home" });
            } else {
                errorMessage.value = "Login failed. Please check your credentials.";
            }
        })
        .catch(() => {
            errorMessage.value = "There was a problem processing your request.";
        });
}

function handleRegister() {
    register.value = !register.value;
    errorMessage.value = "";
}

function handleRegisteration() {
    store
        .dispatch("register", { email: email.value, password: password.value })
        .then(() => {
            if (store.state.isAuthenticated) {
                handleRegister();
                successMessage.value = "Registration successful. Please login.";
            } else {
                errorMessage.value = "Registration failed. Please try again.";
            }
        })
        .catch(() => {
            errorMessage.value = "There was a problem processing your request.";
        });
}
</script>
